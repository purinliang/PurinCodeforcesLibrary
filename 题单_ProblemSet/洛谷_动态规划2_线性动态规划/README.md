题单地址：https://www.luogu.com.cn/training/212#problems

#### P1020 [NOIP1999 提高组] 导弹拦截

每套导弹系统能拦截高度不超过上一次拦截目标的导弹。第一问是问这套系统最多能拦截多少导弹，第二问是问全部拦截这些导弹需要最少多少套这样的系统。这道题由两个问组成，第一问是求最长不上升子序列的长度，第二问是求最长上升子序列的长度。

这里最令人费解的其实是第二问为什么可以这样做，虽然直观上可以猜到这二者的关系。理解不了只能死记一个 **狄尔沃斯（Dilworth）定理：在偏序集中，最小链划分的数量等于最长反链的长度。反之，最小反链划分的数量也等于最长链的长度。** 这个定理证明需要数学归纳法，如果太难理解的话还是把偏序集画出来，用哈斯图去直观感受，在哈斯图中所有极大元素组合成一条反链，这条就是最长反链，当然是等于链划分的数量。

**链：偏序集中的一个子集，里面的元素两两之间都是可比的。
反链：偏序集中的一个子集，里面的元素两两之间都是不可比的。**

再回到这个问题，把每一发炮弹的坐标画在平面图上，会发现这个是个二维偏序问题，一条链是从左上角开始逐个选择每个处于右下方（可以相等）的点得到的结果，考虑从左往右逐个加入这些点，如果新加入的点能接在某条已有的链后面，那么显然链划分的数量不会增加，否则如果新加入的点不能接在任何一条已有的链后面，要么它单独开一个新的链，要么某条链强行选择了它并放弃了另一个点，被放弃的这个点也是不能接在任何一条已有的链后面的。

在这题的二维偏序（具体是 $x_i \geq x_j$ 且 $y_i \geq y_j$ ，也就是处于某个点右下方的才可比）中，链就是从左上到右下的可以坐标相等的点的集合（最长不上升子序列），反链就是从左下到右上的不可以坐标相等的集合（最长上升子序列）。
